{"version":3,"sources":["flipper-hash.ts","matrix-2d.ts","vector-2d.ts","fold.ts","flipper.ts"],"names":[],"mappings":"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AI,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC;YAElE,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC;YAClE,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC;YAClE,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC;YAElE,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC;YAClE,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC;YAClE,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC;SACrE,CAAC,CAAC;IACP,CAAC;IAEM,2BAAQ,GAAf,UAAgB,KAAe;QAC3B,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC,CAAC;IACnD,CAAC;IAEM,4BAAS,GAAhB,UAAiB,MAAgB;QAC7B,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,MAAM,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IACzE,CAAC;IAEM,wBAAK,GAAZ,UAAa,EAAU,EAAE,EAAU;QAC/B,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IAC7D,CAAC;IAEM,yBAAM,GAAb,UAAc,GAAW;QACrB,IAAI,KAAK,GAAG,GAAG,GAAG,IAAI,CAAC,EAAE,GAAG,GAAG,CAAC;QAChC,IAAI,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QACzB,IAAI,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QACzB,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IAChE,CAAC;IAEM,0BAAO,GAAd;QACI,IAAI,GAAG,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC;QAE7B,IAAI,EAAE,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACnB,IAAI,EAAE,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACnB,IAAI,EAAE,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAEnB,IAAI,EAAE,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACnB,IAAI,EAAE,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACnB,IAAI,EAAE,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAEnB,IAAI,EAAE,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACnB,IAAI,EAAE,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACnB,IAAI,EAAE,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAEnB,IAAI,GAAG,GAAG,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,GAAG,CAAC;QACpC,IAAI,GAAG,GAAG,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,GAAG,CAAC;QACpC,IAAI,GAAG,GAAG,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,GAAG,CAAC;QAEpC,IAAI,GAAG,GAAG,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,GAAG,CAAC;QACpC,IAAI,GAAG,GAAG,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,GAAG,CAAC;QACpC,IAAI,GAAG,GAAG,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,GAAG,CAAC;QAEpC,IAAI,GAAG,GAAG,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,GAAG,CAAC;QACpC,IAAI,GAAG,GAAG,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,GAAG,CAAC;QACpC,IAAI,GAAG,GAAG,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,GAAG,CAAC;QAEpC,MAAM,CAAC,IAAI,QAAQ,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;IACvE,CAAC;IAEM,8BAAW,GAAlB;QACI,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;IAC3B,CAAC;IAEO,6BAAU,GAAlB,UAAmB,CAAC;QAChB,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC;IACrC,CAAC;IAEM,yCAAsB,GAA7B;QACI,MAAM,CAAC,YAAU,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,UAAK,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,UAAK,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,UAAK,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,UAAK,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,UAAK,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,MAAG,CAAC;IAC9M,CAAC;IAEL,eAAC;AAAD,CA7GA,AA6GC,IAAA;AC7GD;IAKI,kBAAY,CAAS,EAAE,CAAS;QAC5B,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC;QACX,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC;IACf,CAAC;IAEM,yBAAM,GAAb;QACI,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;IACxD,CAAC;;IAEM,sBAAG,GAAV,UAAW,KAAe;QACtB,MAAM,CAAC,IAAI,QAAQ,CAAC,IAAI,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;IAC5D,CAAC;;IAEM,sBAAG,GAAV,UAAW,KAAe;QACtB,MAAM,CAAC,IAAI,QAAQ,CAAC,IAAI,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;IAC5D,CAAC;;IAEM,sBAAG,GAAV,UAAW,GAAW;QAClB,MAAM,CAAC,IAAI,QAAQ,CAAC,IAAI,CAAC,CAAC,GAAG,GAAG,EAAE,IAAI,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC;IACpD,CAAC;;IAEM,oCAAiB,GAAxB;QACI,MAAM,CAAC,IAAI,QAAQ,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;IACzC,CAAC;;IAEM,2CAAwB,GAA/B;QACI,MAAM,CAAC,IAAI,QAAQ,CAAC,CAAC,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC;IACzC,CAAC;;IAEM,+BAAY,GAAnB,UAAoB,GAAW;QAC3B,IAAI,GAAG,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC;QACxB,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC;YAAC,GAAG,GAAG,CAAC,CAAC;QAClB,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC;IAC/B,CAAC;;IAEM,4BAAS,GAAhB;QACI,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;IAChC,CAAC;IAEM,2BAAQ,GAAf;QACI,MAAM,CAAC,MAAI,IAAI,CAAC,CAAC,UAAK,IAAI,CAAC,CAAC,MAAG,CAAC;IACpC,CAAC;;IAEL,eAAC;AAAD,CAhDA,AAgDC,IAAA;AChDD,oCAAoC;ACApC,oCAAoC;AACpC,oCAAoC;AACpC,+BAA+B;AAC/B,mCAAmC;AACnC,oCAAoC;AAEpC,CAAC,CAAC,EAAE,CAAC,QAAQ,GAAG;IAEZ,cAAc,UAAU;QACpB,IAAI,OAAO,GAAG,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QAEzC,sCAAsC;QACtC,IAAI,UAAwB,CAAC;QAC7B,IAAI,aAA2B,CAAC;QAEhC,qCAAqC;QACrC,IAAI,SAAuB,CAAC;QAC5B,IAAI,YAA0B,CAAC;QAE/B,IAAI,WAAqB,CAAC;QAC1B,IAAI,WAAW,GAAG,EAAE,CAAC;QACrB,IAAI,UAAU,GAAG,CAAC,CAAC;QAEnB,IAAI,kBAAkB,GAAG,KAAK,CAAC;QAE/B,IAAI,mBAA6B,CAAC;QAClC,IAAI,mBAA6B,CAAC;QAClC,IAAI,oBAA8B,CAAC;QACnC,IAAI,oBAA8B,CAAC;QAEnC,IAAI,YAAY,GAAG,OAAO,CAAC,MAAM,EAAE,CAAC;QACpC,IAAI,WAAW,GAAG,OAAO,CAAC,KAAK,EAAE,CAAC;QAClC,IAAI,UAAU,GAAG,YAAY,CAAC;QAC9B,IAAI,SAAS,GAAG,WAAW,GAAG,CAAC,CAAC;QAEhC;;WAEG;QACH,uBAAuB,OAAqB;YACxC,EAAE,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;gBAChC,MAAM,CAAC,IAAI,CAAC;YAChB,CAAC;YAAC,IAAI,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;gBACvC,MAAM,CAAC,IAAI,CAAC;YAChB,CAAC;YAAC,IAAI,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;gBACvC,MAAM,CAAC,IAAI,CAAC;YAChB,CAAC;YAAC,IAAI,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;gBACvC,MAAM,CAAC,IAAI,CAAC;YAChB,CAAC;YAAC,IAAI,CAAC,CAAC;gBACJ,MAAM,CAAC,EAAE,CAAC;YACd,CAAC;QACL,CAAC;QAED;;WAEG;QACH,yBAAyB,MAAc;YACnC,IAAI,CAAC,GAAG,IAAI,QAAQ,EAAE,CAAC;YACvB,MAAM,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;gBACb,KAAK,IAAI;oBACL,MAAM,CAAC,CAAC,CAAC,SAAS,CAAC,IAAI,QAAQ,CAAC,CAAC,WAAW,EAAE,CAAC,YAAY,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;gBAChF,KAAK,IAAI;oBACL,MAAM,CAAC,CAAC,CAAC,SAAS,CAAC,IAAI,QAAQ,CAAC,CAAC,EAAE,CAAC,YAAY,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;gBACpE,KAAK,IAAI;oBACL,MAAM,CAAC,CAAC,CAAC,SAAS,CAAC,IAAI,QAAQ,CAAC,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;gBACnE,KAAK,IAAI;oBACL,MAAM,CAAC,CAAC,CAAC,SAAS,CAAC,IAAI,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YAC3D,CAAC;YAED,MAAM,CAAC,IAAI,CAAC;QAChB,CAAC;QAED,wBAAwB,MAAc;YAClC,MAAM,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;gBACb,KAAK,IAAI,CAAC;gBACV,KAAK,IAAI;oBACL,MAAM,CAAC,CAAC,CAAC;gBACb,KAAK,IAAI,CAAC;gBACV,KAAK,IAAI;oBACL,MAAM,CAAC,CAAC,CAAC,CAAC;YAClB,CAAC;YAED,MAAM,CAAC,CAAC,CAAC;QACb,CAAC;QAED;;WAEG;QACH,iCAAiC,MAAc;YAC3C,IAAI,CAAC,GAAG,IAAI,QAAQ,EAAE,CAAC;YACvB,MAAM,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;gBACb,KAAK,IAAI;oBACL,MAAM,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,IAAI,QAAQ,CAAC,SAAS,EAAE,UAAU,CAAC,CAAC,CAAC;gBAC1E,KAAK,IAAI;oBACL,MAAM,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC,IAAI,QAAQ,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC,CAAC;gBAChE,KAAK,IAAI;oBACL,MAAM,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,IAAI,QAAQ,CAAC,CAAC,EAAE,UAAU,CAAC,CAAC,CAAC;gBACjE,KAAK,IAAI;oBACL,MAAM,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC,IAAI,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;YAC3D,CAAC;QACL,CAAC;QAED;;WAEG;QACH,qBAAqB,MAAc;YAC/B,MAAM,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;gBACb,KAAK,IAAI,CAAC;gBACV,KAAK,IAAI;oBACL,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;gBACrC,KAAK,IAAI,CAAC;gBACV,KAAK,IAAI;oBACL,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YACzC,CAAC;QACL,CAAC;QAED;;WAEG;QACH,sBAAsB,MAAc;YAChC,MAAM,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;gBACb,KAAK,IAAI,CAAC;gBACV,KAAK,IAAI;oBACL,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;gBACrC,KAAK,IAAI,CAAC;gBACV,KAAK,IAAI;oBACL,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YACzC,CAAC;QACL,CAAC;QAED,oBAAoB,MAAc;YAC9B,YAAY,GAAG,OAAO,CAAC,MAAM,EAAE,CAAC;YAChC,WAAW,GAAG,OAAO,CAAC,KAAK,EAAE,CAAC;YAC9B,UAAU,GAAG,YAAY,CAAC;YAC1B,SAAS,GAAG,WAAW,GAAG,CAAC,CAAC;YAE5B,IAAI,QAAQ,GAAG,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;YAC7C,MAAM,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;gBACb,KAAK,IAAI,CAAC;gBACV,KAAK,IAAI;oBACL,UAAU,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;oBACjF,EAAE,CAAC,CAAC,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;wBAC3C,UAAU,EAAE,CAAC;wBACb,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;oBACtH,CAAC;oBACD,KAAK,CAAC;gBACV,KAAK,IAAI,CAAC;gBACV,KAAK,IAAI;oBACL,UAAU,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC;oBACjF,EAAE,CAAC,CAAC,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;wBAClD,UAAU,EAAE,CAAC;wBACb,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;oBACjI,CAAC;oBACD,KAAK,CAAC;gBACV;oBACI,UAAU,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;oBACvF,KAAK,CAAC;YACd,CAAC;YAED,UAAU,GAAG,YAAY,CAAC,MAAM,CAAC,CAAC;YAClC,SAAS,GAAG,WAAW,CAAC,MAAM,CAAC,CAAC;YAEhC,aAAa,GAAG,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YACvC,YAAY,GAAG,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YAErC,WAAW,GAAG,MAAM,CAAC;YACrB,UAAU,GAAG,cAAc,CAAC,MAAM,CAAC,CAAC;YAEpC,mBAAmB,GAAG,eAAe,CAAC,MAAM,CAAC,CAAC;YAC9C,mBAAmB,GAAG,mBAAmB,CAAC,OAAO,EAAE,CAAC;YAEpD,oBAAoB,GAAG,uBAAuB,CAAC,MAAM,CAAC,CAAC;YACvD,oBAAoB,GAAG,oBAAoB,CAAC,OAAO,EAAE,CAAC;QAC1D,CAAC;QAED;;WAEG;QACH,mBAAmB,MAAgB;YAC/B,EAAE,CAAC,CAAC,MAAM,CAAC,MAAM,EAAE,GAAG,EAAE,CAAC;gBAAC,MAAM,GAAG,IAAI,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YAEtD,IAAI,WAAW,GAAG,IAAI,QAAQ,CAAC,SAAS,EAAE,UAAU,CAAC,CAAC;YACtD,IAAI,OAAO,GAAG,WAAW,CAAC,MAAM,EAAE,CAAC;YACnC,IAAI,IAAI,GAAG,MAAM,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;YACnC,EAAE,CAAC,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,OAAO,CAAC,CAAC,CAAC;gBAC1B,IAAI,GAAG,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;gBAClC,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;YACnC,CAAC;YAED,IAAI,WAAW,GAAG,IAAI,QAAQ,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC;YAC7C,IAAI,GAAG,GAAG,MAAM,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;YAClC,EAAE,CAAC,CAAC,GAAG,CAAC,MAAM,EAAE,GAAG,SAAS,CAAC,CAAC,CAAC;gBAC3B,GAAG,GAAG,GAAG,CAAC,YAAY,CAAC,SAAS,CAAC,CAAC;gBAClC,MAAM,GAAG,GAAG,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;YAClC,CAAC;YAED,MAAM,CAAC,MAAM,CAAC;QAClB,CAAC;QAED;;WAEG;QACH,wBAAwB,CAAS,EAAE,CAAS,EAAE,CAAS,EAAE,CAAS;YAC9D,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YACX,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;gBAAC,MAAM,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;YACxC,CAAC,IAAI,CAAC,CAAC;YACP,MAAM,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;QACvC,CAAC;QAAA,CAAC;QAEF,CAAC;YACG,IAAI,cAAwB,CAAC;YAC7B,IAAI,KAAK,GAAG,MAAM,CAAC;YACnB,IAAI,OAAqB,CAAC;YAE1B,IAAI,QAAQ,GAAG,IAAI,CAAC;YACpB,IAAI,eAAe,GAAG,IAAI,CAAC;YAE3B,0BAA0B,EAAgB;gBACtC,EAAE,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;oBAChC,IAAI,UAAU,GAAe,EAAE,CAAC,aAAa,CAAA;oBAC7C,IAAI,KAAK,GAAG,UAAU,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,UAAU,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC;oBAClE,MAAM,CAAC,IAAI,QAAQ,CAAC,KAAK,CAAC,OAAO,EAAE,KAAK,CAAC,OAAO,CAAC,CAAC;gBACtD,CAAC;gBACD,MAAM,CAAC,IAAI,QAAQ,CAAC,EAAE,CAAC,OAAO,EAAE,EAAE,CAAC,OAAO,CAAC,CAAC;YAChD,CAAC;YAED,wBAAwB,CAAW,EAAE,CAAW;gBAC5C,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;YACjC,CAAC;YAED,wBAAwB,EAAgB;gBACpC,IAAI,GAAG,GAAG,gBAAgB,CAAC,EAAE,CAAC,CAAC;gBAC/B,IAAI,IAAI,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC,qBAAqB,EAAE,CAAC;gBAC9C,IAAI,KAAK,GAAG,IAAI,QAAQ,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC;gBAC9C,MAAM,CAAC;oBACH,GAAG,EAAE,GAAG,CAAC,GAAG,CAAC,KAAK,CAAC;oBACnB,OAAO,EAAE,OAAO;oBAChB,KAAK,EAAE,EAAE;iBACZ,CAAC;YACN,CAAC;YAED,mBAAmB,EAAgB;gBAC/B,IAAI,IAAI,GAAG,cAAc,CAAC,EAAE,CAAC,CAAC;gBAC9B,IAAI,MAAM,GAAG,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;gBACzC,UAAU,CAAC,MAAM,CAAC,CAAC;gBAEnB,QAAQ,GAAG,EAAE,CAAC;gBACd,eAAe,GAAG,IAAI,CAAC;gBACvB,MAAM,CAAC,IAAI,CAAC;YAChB,CAAC;YAED,kBAAkB,EAAgB;gBAC9B,EAAE,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;oBACX,QAAQ,CAAC,EAAE,CAAC,CAAC;gBACjB,CAAC;YACL,CAAC;YAED,kBAAkB,EAAgB;gBAC9B,IAAI,IAAI,GAAG,cAAc,CAAC,EAAE,CAAC,CAAC;gBAC9B,WAAW,GAAG,mBAAmB,CAAC,eAAe,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;gBAC5D,OAAO,CAAC,WAAW,CAAC,CAAC;YACzB,CAAC;YAED,qBAAqB,MAAgB;gBACjC,IAAI,KAAK,GAAG,WAAW,CAAC;gBACxB,IAAI,KAAK,GAAG,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;gBAC9B,MAAM,CAAC,OAAO,CAAC,UAAC,KAAa;oBACzB,IAAI,MAAM,GAAG,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;oBACzC,WAAW,GAAG,MAAM,CAAC;oBACrB,OAAO,CAAC,MAAM,CAAC,CAAC;gBACpB,CAAC,CAAC,CAAC,IAAI,CAAC;oBACJ,UAAU,EAAE,CAAC;oBACb,KAAK,EAAE,CAAC;gBACZ,CAAC,CAAC,CAAC;YACP,CAAC;YAED,iBAAiB,EAAgB;gBAC7B,EAAE,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;oBACX,IAAI,WAAW,GAAG,OAAO,CAAC,KAAK,EAAE,CAAC;oBAClC,IAAI,SAAS,GAAG,WAAW,GAAG,CAAC,CAAC;oBAChC,EAAE,CAAC,CAAC,WAAW,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC;wBAC5B,WAAW,CAAC,IAAI,QAAQ,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;4BAC3C,YAAY,CAAC,UAAU,CAAC,CAAC;wBAC7B,CAAC,CAAC,CAAC;oBACP,CAAC;oBAAC,IAAI,CAAC,CAAC;wBACJ,UAAU,CAAC,EAAE,CAAC,CAAC;oBACnB,CAAC;oBACD,QAAQ,GAAG,IAAI,CAAC;gBACpB,CAAC;YACL,CAAC;YAED,oBAAoB,EAAgB;gBAChC,EAAE,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;oBACX,WAAW,CAAC,IAAI,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;oBAChC,QAAQ,GAAG,IAAI,CAAC;gBACpB,CAAC;YACL,CAAC;YAED,mBAAmB,EAAgB,EAAE,SAAkB;gBACnD,EAAE,CAAC,CAAC,KAAK,KAAK,MAAM,CAAC,CAAC,CAAC;oBACnB,EAAE,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC;wBACZ,EAAE,CAAC,cAAc,EAAE,CAAC;wBACpB,EAAE,CAAC,eAAe,EAAE,CAAC;oBACzB,CAAC;oBACD,MAAM,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;gBACxB,CAAC;gBAAC,IAAI,CAAC,EAAE,CAAC,CAAC,KAAK,KAAK,WAAW,CAAC,CAAC,CAAC;oBAC/B,IAAI,GAAG,GAAG,gBAAgB,CAAC,EAAE,CAAC,CAAC;oBAC/B,EAAE,CAAC,CAAC,cAAc,CAAC,cAAc,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC;wBACtC,KAAK,GAAG,MAAM,CAAC;wBACf,IAAI,GAAG,GAAG,SAAS,CAAC,EAAE,CAAC,CAAC;wBACxB,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC;4BAAC,KAAK,GAAG,MAAM,CAAC;wBACzB,MAAM,CAAC,GAAG,CAAC;oBACf,CAAC;gBACL,CAAC;gBACD,MAAM,CAAC,IAAI,CAAC;YAChB,CAAC;YAED,CAAC,CAAC,YAAY,CAAC,CAAC,EAAE,CAAC,sBAAsB,EAAE,oBAAoB,EAAE,UAAU,EAAE;gBACzE,IAAI,SAAS,GAAG,CAAC,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC;gBAC7B,EAAE,CAAC,CAAC,KAAK,KAAK,MAAM,CAAC,CAAC,CAAC;oBACnB,cAAc,GAAG,gBAAgB,CAAC,EAAE,CAAC,CAAC;oBACtC,EAAE,CAAC,cAAc,EAAE,CAAC;oBACpB,EAAE,CAAC,eAAe,EAAE,CAAC;oBACrB,KAAK,GAAG,WAAW,CAAC;oBACpB,OAAO,GAAG,SAAS,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;gBAC3C,CAAC;YACL,CAAC,CAAC,CAAC,EAAE,CAAC,qBAAqB,EAAE,oBAAoB,EAAE,UAAU,EAAE;gBAC3D,EAAE,CAAC,CAAC,QAAQ,CAAC;oBAAC,MAAM,CAAC;gBACrB,eAAe,GAAG,EAAE,CAAC;gBACrB,OAAO,GAAG,CAAC,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;gBAC1C,IAAI,IAAI,GAAG,cAAc,CAAC,EAAE,CAAC,CAAC;gBAC9B,IAAI,MAAM,GAAG,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;gBACzC,UAAU,CAAC,MAAM,CAAC,CAAC;gBACnB,QAAQ,CAAC,EAAE,CAAC,CAAC;YACjB,CAAC,CAAC,CAAC,EAAE,CAAC,mBAAmB,EAAE,oBAAoB,EAAE,UAAU,EAAE;gBACzD,EAAE,CAAC,CAAC,CAAC,eAAe,CAAC;oBAAC,MAAM,CAAC;gBAC7B,eAAe,GAAG,IAAI,CAAC;gBACvB,WAAW,CAAC,IAAI,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;YACpC,CAAC,CAAC,CAAC,IAAI,CAAC,qBAAqB,EAAE,UAAU,EAAE;gBACvC,MAAM,CAAC,SAAS,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;YAC/B,CAAC,CAAC,CAAC,IAAI,CAAC,YAAY,EAAE,UAAU,EAAE;gBAC9B,MAAM,CAAC,SAAS,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;YAChC,CAAC,CAAC,CAAC,IAAI,CAAC,kBAAkB,EAAE,UAAU,EAAgB;gBAClD,EAAE,CAAC,CAAC,KAAK,KAAK,MAAM,CAAC,CAAC,CAAC;oBACnB,EAAE,CAAC,cAAc,EAAE,CAAC;oBACpB,EAAE,CAAC,eAAe,EAAE,CAAC;oBACrB,OAAO,CAAC,EAAE,CAAC,CAAC;gBAChB,CAAC;gBAAC,IAAI,CAAC,EAAE,CAAC,CAAC,KAAK,KAAK,WAAW,CAAC,CAAC,CAAC;oBAC/B,YAAY,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC,CAAC;gBACzC,CAAC;gBACD,KAAK,GAAG,MAAM,CAAC;YACnB,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,EAAE,UAAU,EAAE;gBAC3B,EAAE,CAAC,CAAC,CAAC,QAAQ,CAAC;oBAAC,MAAM,CAAC;gBAEtB,EAAE,CAAC,CAAC,EAAE,CAAC,OAAO,KAAK,EAAE,CAAC,CAAC,CAAC;oBACpB,UAAU,CAAC,EAAE,CAAC,CAAC;gBACnB,CAAC;YACL,CAAC,CAAC,CAAC;QAEP,CAAC,CAAC,EAAE,CAAC;QAEL;;;WAGG;QACH,4BAA4B,KAAa;YACrC,IAAI,KAAK,GAAG,EAAE,GAAG,EAAE,GAAG,KAAK,CAAC,CAAC,4CAA4C;YACzE,KAAK,GAAG,KAAK,GAAG,IAAI,CAAC,EAAE,GAAG,GAAG,CAAC;YAE9B,IAAI,EAAE,GAAG,KAAK,GAAG,SAAS,CAAC;YAC3B,IAAI,EAAE,GAAG,CAAC,CAAC;YAEX,IAAI,KAAK,GAAG,IAAI,QAAQ,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;YAEjC,IAAI,GAAG,GAAG,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;YAC/B,IAAI,GAAG,GAAG,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;YAChC,IAAI,GAAG,GAAG,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;YAEhC,IAAI,MAAM,GAAG,IAAI,QAAQ,CAAC,EAAE,GAAG,GAAG,EAAE,GAAG,CAAC,CAAC;YAEzC,MAAM,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;QACzB,CAAC;QAED,kBAAkB,MAAgB,EAAE,MAAgB,EAAE,MAAgB;YAClE,IAAI,EAAE,GAAG,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;YAE5B,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;gBACZ,MAAM,CAAC,IAAI,QAAQ,CAAC,MAAM,CAAC,CAAC,EAAE,UAAU,CAAC,CAAC;YAC9C,CAAC;YACD,IAAI,EAAE,GAAG,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;YAC1B,EAAE,CAAC,CAAC,EAAE,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC;gBACrB,MAAM,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;YAClC,CAAC;YAED,IAAI,EAAE,GAAG,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;YAC5B,IAAI,EAAE,GAAG,CAAC,UAAU,GAAG,MAAM,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;YACxC,MAAM,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;QAClC,CAAC;QAED,+BAA+B,MAAgB;YAC3C,IAAI,MAAM,GAAG,MAAM,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;YAC7B,IAAI,YAAY,GAAG,MAAM,CAAC,iBAAiB,EAAE,CAAC,CAAC,+CAA+C;YAE9F,IAAI,KAAe,CAAC;YACpB,EAAE,CAAC,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;gBACtB,IAAI,EAAE,GAAG,CAAC,MAAM,CAAC,CAAC,GAAG,YAAY,CAAC,CAAC,CAAC;gBACpC,KAAK,GAAG,MAAM,CAAC,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC;YAC7C,CAAC;YAAC,IAAI,CAAC,CAAC;gBACJ,KAAK,GAAG,IAAI,QAAQ,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YACtC,CAAC;YAED,IAAI,MAAgB,CAAC;YACrB,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,IAAI,MAAM,CAAC,CAAC,IAAI,KAAK,CAAC,CAAC,IAAI,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC7C,MAAM,GAAG,MAAM,CAAC,GAAG,CAAC,IAAI,QAAQ,CAAC,CAAC,EAAE,UAAU,CAAC,CAAC,CAAC;YACrD,CAAC;YAAC,IAAI,CAAC,CAAC;gBACJ,MAAM,GAAG,KAAK,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,iBAAiB,EAAE,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;YACxF,CAAC;YAED,IAAI,MAAM,GAAG,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,iBAAiB,EAAE,CAAC,YAAY,CAAC,SAAS,CAAC,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;YACxF,IAAI,MAAM,GAAG,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,iBAAiB,EAAE,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;YAEzF,MAAM,CAAC;gBACH,MAAM,EAAE,MAAM;gBACd,MAAM,EAAE,MAAM;gBACd,MAAM,EAAE,MAAM;gBACd,MAAM,EAAE,MAAM;gBACd,MAAM,EAAE,IAAI,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC;gBAC1B,KAAK,EAAE,KAAK;gBACZ,KAAK,EAAE,QAAQ,CAAC,MAAM,EAAE,MAAM,EAAE,MAAM,CAAC;aAC1C,CAAA;QACL,CAAC;QAED;YACI,IAAI,MAAM,GAAG,WAAW,CAAC,CAAA,6BAA6B;YACtD,MAAM,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC;YAC3B,IAAI,IAAI,GAAG,qBAAqB,CAAC,MAAM,CAAC,CAAC;YAEzC,MAAM,CAAC;gBACH,KAAK,EAAE,IAAI,CAAC,KAAK;gBACjB,KAAK,EAAE,IAAI,CAAC,KAAK;gBACjB,MAAM,EAAE,IAAI,CAAC,MAAM;gBACnB,MAAM,EAAE,IAAI,CAAC,MAAM;gBACnB,MAAM,EAAE,IAAI,CAAC,MAAM;gBACnB,MAAM,EAAE,IAAI,CAAC,MAAM;gBACnB,MAAM,EAAE,IAAI,CAAC,MAAM;aACtB,CAAC;QACN,CAAC;QAED,kBAAkB,SAAgB;YAC9B,oBAAoB,MAAoB,EAAE,MAAgB;gBACtD,MAAM,GAAG,mBAAmB,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;gBACrD,MAAM,CAAC,GAAG,CAAC;oBACP,IAAI,EAAE,CAAC,GAAG,GAAG,MAAM,CAAC,CAAC,GAAG,WAAW,CAAC,GAAG,GAAG;oBAC1C,GAAG,EAAE,CAAC,GAAG,GAAG,MAAM,CAAC,CAAC,GAAG,YAAY,CAAC,GAAG,GAAG;iBAC7C,CAAC,CAAA;YACN,CAAC;YAED,UAAU,CAAC,CAAC,CAAC,eAAe,CAAC,EAAE,SAAS,CAAC,KAAK,CAAC,CAAC;YAChD,UAAU,CAAC,CAAC,CAAC,eAAe,CAAC,EAAE,SAAS,CAAC,KAAK,CAAC,CAAC;YAChD,UAAU,CAAC,CAAC,CAAC,UAAU,CAAC,EAAE,SAAS,CAAC,MAAM,CAAC,CAAC;YAC5C,UAAU,CAAC,CAAC,CAAC,UAAU,CAAC,EAAE,SAAS,CAAC,MAAM,CAAC,CAAC;YAC5C,UAAU,CAAC,CAAC,CAAC,UAAU,CAAC,EAAE,SAAS,CAAC,MAAM,CAAC,CAAC;YAC5C,UAAU,CAAC,CAAC,CAAC,UAAU,CAAC,EAAE,SAAS,CAAC,MAAM,CAAC,CAAC;YAC5C,UAAU,CAAC,CAAC,CAAC,UAAU,CAAC,EAAE,SAAS,CAAC,MAAM,CAAC,CAAC;QAChD,CAAC;QAED,4BAA4B,MAAgB,EAAE,MAAgB,EAAE,MAAgB;YAC5E,IAAI,KAAK,GAAG,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC;YAClD,IAAI,KAAK,GAAG,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,UAAU,CAAC,CAAC;YACnD,MAAM,CAAC,IAAI,QAAQ,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,KAAK,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;QAC/F,CAAC;QAED;;WAEG;QACH,mCAAmC,MAAgB,EAAE,MAAgB,EAAE,MAAgB,EAAE,MAAgB;YACrG,IAAI,KAAK,GAAG,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;YAC/B,IAAI,KAAK,GAAG,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;YAC/B,IAAI,IAAI,GAAG,KAAK,CAAC,SAAS,EAAE,CAAC;YAC7B,IAAI,IAAI,GAAG,KAAK,CAAC,SAAS,EAAE,CAAC;YAC7B,IAAI,UAAU,GAAG,IAAI,QAAQ,CAAC,CAAC,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;YAE/E,8CAA8C;YAC9C,IAAI,MAAM,GAAG,UAAU,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;YAC1C,IAAI,OAAO,GAAG,MAAM,CAAC,OAAO,EAAE,CAAC;YAC/B,IAAI,UAAU,GAAG,OAAO,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;YAEjD,IAAI,EAAE,GAAG,UAAU,CAAC,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC;YACvC,IAAI,EAAE,GAAG,UAAU,CAAC,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC;YACvC,IAAI,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC;YAC5B,MAAM,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;QACpD,CAAC;QAED;;;;WAIG;QACH,mBAAmB,KAAmB,EAAE,IAAkB,EAAE,UAAoB,EAAE,aAAuB;YACrG,UAAU,GAAG,UAAU,CAAC,QAAQ,CAAC,mBAAmB,CAAC,CAAC;YACtD,aAAa,GAAG,aAAa,CAAC,QAAQ,CAAC,mBAAmB,CAAC,CAAC;YAE5D,KAAK,CAAC,GAAG,CAAC;gBACN,SAAS,EAAE,aAAa,CAAC,sBAAsB,EAAE;aACpD,CAAC,CAAA;YAEF,UAAU,GAAG,UAAU,CAAC,QAAQ,CAAC,aAAa,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC,2BAA2B;YAEtF,IAAI,CAAC,GAAG,CAAC;gBACL,SAAS,EAAE,UAAU,CAAC,sBAAsB,EAAE;aACjD,CAAC,CAAA;QACN,CAAC;QAED,uBAAuB,IAAW;YAC9B,IAAI,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,SAAS,EAAE,CAAC;YACzD,IAAI,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,SAAS,EAAE,CAAC;YACzD,IAAI,UAAU,GAAG,IAAI,QAAQ,CAAC,CAAC,SAAS,CAAC,CAAC,EAAE,SAAS,CAAC,CAAC,EAAE,CAAC,EAAE,SAAS,CAAC,CAAC,EAAE,SAAS,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAE1H,MAAM,CAAC,oBAAoB,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;QACrD,CAAC;QAED,uBAAuB,SAAgB;YACnC,IAAI,UAAU,GAAG,aAAa,CAAC,SAAS,CAAC,CAAC;YAE1C,IAAI,aAAuB,CAAC;YAC5B,EAAE,CAAC,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,GAAG,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;gBACxC,aAAa,GAAG,kBAAkB,CAAC,SAAS,CAAC,KAAK,EAAE,SAAS,CAAC,MAAM,EAAE,SAAS,CAAC,KAAK,CAAC,CAAC;YAC3F,CAAC;YAAC,IAAI,CAAC,CAAC;gBACJ,aAAa,GAAG,kBAAkB,CAAC,SAAS,CAAC,KAAK,EAAE,SAAS,CAAC,MAAM,EAAE,SAAS,CAAC,KAAK,CAAC,CAAC;YAC3F,CAAC;YAED,SAAS,CAAC,SAAS,EAAE,YAAY,EAAE,UAAU,EAAE,aAAa,CAAC,CAAC;QAClE,CAAC;QAED,wBAAwB,SAAgB;YACpC,IAAI,KAAK,GAAG,oBAAoB,CAAC,eAAe,CAAC,IAAI,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;YACrE,KAAK,GAAG,mBAAmB,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;YACnD,IAAI,UAAU,GAAG,IAAI,QAAQ,EAAE,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,QAAQ,CAAC,mBAAmB,CAAC,CAAC;YAE/E,IAAI,MAAM,GAAG,IAAI,QAAQ,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,qDAAqD;YACrG,IAAI,MAAM,GAAG,IAAI,QAAQ,CAAC,SAAS,EAAE,UAAU,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,qDAAqD;YAC9G,IAAI,aAAuB,CAAC;YAC5B,EAAE,CAAC,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,GAAG,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;gBACxC,aAAa,GAAG,yBAAyB,CAAC,SAAS,CAAC,KAAK,EAAE,MAAM,EAAE,SAAS,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;YAChG,CAAC;YAAC,IAAI,CAAC,CAAC;gBACJ,aAAa,GAAG,yBAAyB,CAAC,SAAS,CAAC,KAAK,EAAE,MAAM,EAAE,SAAS,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;YAChG,CAAC;YAED,SAAS,CAAC,UAAU,EAAE,aAAa,EAAE,UAAU,EAAE,aAAa,CAAC,CAAC;QACpE,CAAC;QAED,iBAAiB,MAAgB;YAC7B,IAAI,SAAS,GAAG,aAAa,EAAE,CAAC;YAEhC,aAAa,CAAC,SAAS,CAAC,CAAC;YACzB,cAAc,CAAC,SAAS,CAAC,CAAC;YAE1B,uBAAuB;QAC3B,CAAC;QAED;YACI,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,WAAW,CAAC,yBAAyB,CAAC,CAAA;QACvE,CAAC;QAED;YACI,UAAU,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,WAAW,EAAE,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,GAAG,CAAC,WAAW,EAAE,EAAE,CAAC,CAAC;QACtG,CAAC;QAED;YACI,IAAI,QAAQ,GAAG,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;YAC7C,IAAI,KAAK,GAAG,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAChC,IAAI,KAAK,GAAG,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAChC,UAAU,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,CAAC,KAAK,CAAC,MAAM,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC;YACjF,UAAU,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,CAAC,KAAK,CAAC,MAAM,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC;YAEjF,IAAI,QAAQ,GAAG,CAAC,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,MAAM,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;YACzF,UAAU,CAAC,WAAW,CAAC,WAAW,EAAE,QAAQ,CAAC,CAAA;QACjD,CAAC;QAED,sBAAsB,KAAa;YAC/B,IAAI,QAAQ,GAAG,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;YAC7C,IAAI,WAAW,GAAG,UAAU,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;YAEpD,IAAI,KAAK,GAAG,QAAQ,CAAC;YACrB,IAAI,QAAQ,GAAG,WAAW,CAAC;YAC3B,OAAO,KAAK,IAAI,CAAC,EAAE,CAAC;gBAChB,KAAK,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBAAA,CAAC;gBACrC,QAAQ,GAAG,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBAAA,CAAC;gBAC3C,KAAK,IAAI,CAAC,CAAC;YACf,CAAC;YACD,OAAO,KAAK,IAAI,CAAC,CAAC,EAAE,CAAC;gBACjB,KAAK,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBAAA,CAAC;gBACrC,QAAQ,GAAG,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBAAA,CAAC;gBAC3C,KAAK,IAAI,CAAC,CAAC;YACf,CAAC;YACD,OAAO,KAAK,IAAI,CAAC,EAAE,CAAC;gBAChB,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,KAAK,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;oBAC3B,QAAQ,GAAG,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBACnC,CAAC;gBAAC,IAAI,CAAC,CAAC;oBACJ,KAAK,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;oBACpC,QAAQ,GAAG,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBACnC,CAAC;gBACD,KAAK,EAAE,CAAC;YACZ,CAAC;YACD,OAAO,KAAK,IAAI,CAAC,CAAC,EAAE,CAAC;gBACjB,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,KAAK,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;oBAC3B,KAAK,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;oBACpC,QAAQ,GAAG,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBACnC,CAAC;gBAAC,IAAI,CAAC,CAAC;oBACJ,QAAQ,GAAG,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBACnC,CAAC;gBACD,KAAK,EAAE,CAAC;YACZ,CAAC;YACD,EAAE,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC;gBACf,QAAQ,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;gBAChC,WAAW,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;gBACvC,KAAK,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;gBAC1B,QAAQ,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC;YACrC,CAAC;YAED,YAAY,EAAE,CAAC;YAEf,aAAa,EAAE,CAAC;YAEhB,MAAM,CAAC,KAAK,CAAC;QACjB,CAAC;QAED,iBAAiB,QAA6B;YAC1C,IAAI,OAAO,GAAG,CAAC,CAAC,QAAQ,EAAE,CAAC;YAC3B,EAAE,CAAC,CAAC,kBAAkB,CAAC,CAAC,CAAC;gBACrB,OAAO,CAAC,MAAM,EAAE,CAAC;gBACjB,MAAM,CAAC,OAAO,CAAC;YACnB,CAAC;YAED,kBAAkB,GAAG,IAAI,CAAC;YAG1B,IAAI,KAAK,GAAG,CAAC,CAAC;YACd,IAAI,IAAI,GAAG,CAAC,CAAC;YAEb,QAAQ,CAAC,CAAC,CAAC,CAAC;YAEZ;gBACI,qBAAqB,CAAC;oBAClB,KAAK,IAAI,IAAI,CAAC;oBACd,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;oBAC7B,IAAI,CAAC,GAAG,cAAc,CAAC,KAAK,GAAG,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;oBAC7C,QAAQ,CAAC,CAAC,CAAC,CAAA;oBACX,EAAE,CAAC,CAAC,KAAK,GAAG,GAAG,CAAC,CAAC,CAAC;wBACd,IAAI,EAAE,CAAC;oBACX,CAAC;oBAAC,IAAI,CAAC,CAAC;wBACJ,kBAAkB,GAAG,KAAK,CAAC;wBAC3B,OAAO,CAAC,OAAO,EAAE,CAAC;oBACtB,CAAC;gBACL,CAAC,CAAC,CAAC;YACP,CAAC;YAED,IAAI,EAAE,CAAC;YAEP,MAAM,CAAC,OAAO,CAAC;QACnB,CAAC;QAED,sBAAsB,MAAc;YAChC,UAAU,CAAC,MAAM,CAAC,CAAC;YACnB,OAAO,CAAC,UAAA,KAAK;gBACT,IAAI,MAAM,GAAG,kBAAkB,CAAC,KAAK,CAAC,CAAC;gBACvC,WAAW,GAAG,MAAM,CAAC;gBACrB,OAAO,CAAC,WAAW,CAAC,CAAC;YACzB,CAAC,CAAC,CAAC,IAAI,CAAC;gBACJ,UAAU,EAAE,CAAC;gBACb,KAAK,EAAE,CAAC;gBACR,YAAY,CAAC,UAAU,CAAC,CAAC;YAC7B,CAAC,CAAC,CAAC;QACP,CAAC;QAED;YACI,iBAAiB,EAAE,CAAC;YACpB,iBAAiB,EAAE,CAAC;QACxB,CAAC;QAED,IAAI,UAAU,GAAG,EAAE,CAAC;QAEpB,sBAAsB,IAAkB;YACpC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC;gBAAC,MAAM,CAAC;YACzB,IAAI,OAAO,GAAqB,IAAI,CAAC,CAAC,CAAC,CAAC;YACxC,IAAI,GAAG,GAAG,OAAO,CAAC,GAAG,CAAC;YACtB,IAAI,GAAG,GAAG,IAAI,KAAK,EAAE,CAAA;YACrB,GAAG,CAAC,GAAG,GAAG,GAAG,CAAC;YACd,GAAG,CAAC,MAAM,GAAG;gBACT,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;YACrB,CAAC,CAAA;YACD,UAAU,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC;QAC1B,CAAC;QAED;YACI,IAAI,QAAQ,GAAG,OAAO,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;YAC1C,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC;gBACzB,QAAQ,GAAG,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBAC/B,IAAI,IAAI,GAAG,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;gBAChC,YAAY,CAAC,IAAI,CAAC,CAAC;YACvB,CAAC;QACL,CAAC;QAED;YACI,IAAI,QAAQ,GAAG,OAAO,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;YAC1C,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC;gBACzB,QAAQ,GAAG,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBAC/B,IAAI,IAAI,GAAG,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;gBAChC,YAAY,CAAC,IAAI,CAAC,CAAC;YACvB,CAAC;QACL,CAAC;QAED;YACI,IAAI,QAAQ,GAAG,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACxD,EAAE,CAAC,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC;gBAClB,YAAY,CAAC,IAAI,CAAC,CAAC;YACvB,CAAC;QACL,CAAC;QAED;YACI,IAAI,QAAQ,GAAG,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACxD,EAAE,CAAC,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC;gBAClB,YAAY,CAAC,IAAI,CAAC,CAAC;YACvB,CAAC;QACL,CAAC;QAED,kBAAkB,UAAkB;YAChC,IAAI,MAAM,GAAG,UAAU,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;YAC1E,UAAU,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,UAAU,CAAC,EAAE,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;YAClE,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC;gBACxC,IAAI,IAAI,GAAG,CAAC,GAAG,CAAC,CAAC;gBACjB,IAAI,MAAM,GAAG,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC1B,MAAM,CAAC,WAAW,CAAC,SAAS,EAAE,IAAI,IAAI,UAAU,IAAI,CAAC,IAAI,GAAG,CAAC,CAAC,IAAI,UAAU,CAAC,CAAC;gBAC9E,MAAM,CAAC,WAAW,CAAC,aAAa,EAAE,IAAI,IAAI,UAAU,CAAC,CAAC;gBACtD,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC;oBACxB,IAAI,MAAM,GAAG,CAAC,CAAC,MAAM,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;oBAC9B,MAAM,CAAC,WAAW,CAAC,aAAa,EAAE,CAAC,IAAI,GAAG,CAAC,CAAC,IAAI,UAAU,CAAC,CAAC;gBAChE,CAAC;YACL,CAAC;QACL,CAAC;QAED,aAAa,EAAE,CAAC;QAChB,YAAY,EAAE,CAAC;QAEf,MAAM,CAAC;YACH,mBAAmB,EAAE,mBAAmB;YACxC,kBAAkB,EAAE,kBAAkB;YACtC,YAAY,EAAE,YAAY;YAC1B,QAAQ,EAAE,QAAQ;SACrB,CAAA;IACL,CAAC;IAED,IAAI,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;IAClC,EAAE,CAAC,CAAC,IAAI,CAAC;QAAC,MAAM,CAAC,IAAI,CAAC;IACtB,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC;IAClB,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC;IAC7B,MAAM,CAAC,IAAI,CAAC;AAChB,CAAC,CAAC;AAEF,CAAC,CAAC,QAAQ,CAAC,CAAC,KAAK,CAAC;IACd,IAAI,IAAI,GAAG,CAAC,CAAC,YAAY,CAAC,CAAC,QAAQ,EAAE,CAAC;IACtC,CAAC,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,OAAO,EAAE,wBAAwB,EAAE;QAC5C,IAAI,CAAC,kBAAkB,EAAE,CAAC;IAC9B,CAAC,CAAC,CAAC,EAAE,CAAC,OAAO,EAAE,wBAAwB,EAAE;QACrC,IAAI,CAAC,mBAAmB,EAAE,CAAC;IAC/B,CAAC,CAAC,CAAC,EAAE,CAAC,OAAO,EAAE,sBAAsB,EAAE;QACnC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;IACzB,CAAC,CAAC,CAAC,EAAE,CAAC,OAAO,EAAE,sBAAsB,EAAE;QACnC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC;IAC1B,CAAC,CAAC,CAAC;AACP,CAAC,CAAC,CAAC","file":"flipper.js","sourcesContent":["///<reference path=\"jquery.d.ts\" />\r\n///<reference path=\"flipper.d.ts\" />\r\n\r\n$(document).ready(() => {\r\n\r\n    var regex = /#magazine:(\\d+)/i;\r\n    \r\n    function refresh() {\r\n        var hash = window.location.hash || '#';\r\n        var res = regex.exec(hash);\r\n        if (res) {\r\n            var pageNumber = parseInt(res[1], 10);\r\n            var pageTurn = $('.page-turn').pageTurn();\r\n            pageTurn.navigate(pageNumber);\r\n        }\r\n    }\r\n\r\n    $(window).bind('hashchange', () => {\r\n        refresh();\r\n    });\r\n\r\n    refresh();\r\n\r\n});","class Matrix2D {\r\n\r\n    private m: number[];\r\n\r\n    constructor(elements?: number[]) {\r\n        this.m = elements || [1, 0, 0, 0, 1, 0, 0, 0, 1];\r\n    }\r\n\r\n    public transformVector(v: Vector2D) : Vector2D {\r\n        return new Vector2D(\r\n            v.x * this.m[0] + v.y * this.m[3] + this.m[6],\r\n            v.x * this.m[1] + v.y * this.m[4] + this.m[7]\r\n        );\r\n    }\r\n\r\n    public determinant() {\r\n        var ax = this.m[0];\r\n        var ay = this.m[1];\r\n        var az = this.m[2];\r\n        var bx = this.m[3];\r\n        var by = this.m[4];\r\n        var bz = this.m[5];\r\n        var cx = this.m[6];\r\n        var cy = this.m[7];\r\n        var cz = this.m[8];\r\n\r\n        var dx = by * cz - bz * cy;\r\n        var dy = bz * cx - bx * cz;\r\n        var dz = bx * cy - by * cx;\r\n        return ax * dx + ay * dy + az * dz;\r\n    }\r\n\r\n    private multiplyArray(other: number[]) {\r\n        return new Matrix2D([\r\n            this.m[0] * other[0] + this.m[1] * other[3] + this.m[2] * other[6],\r\n            this.m[0] * other[1] + this.m[1] * other[4] + this.m[2] * other[7],\r\n            this.m[0] * other[2] + this.m[1] * other[5] + this.m[2] * other[8],\r\n\r\n            this.m[3] * other[0] + this.m[4] * other[3] + this.m[5] * other[6],\r\n            this.m[3] * other[1] + this.m[4] * other[4] + this.m[5] * other[7],\r\n            this.m[3] * other[2] + this.m[4] * other[5] + this.m[5] * other[8],\r\n\r\n            this.m[6] * other[0] + this.m[7] * other[3] + this.m[8] * other[6],\r\n            this.m[6] * other[1] + this.m[7] * other[4] + this.m[8] * other[7],\r\n            this.m[6] * other[2] + this.m[7] * other[5] + this.m[8] * other[8]\r\n        ]);\r\n    }\r\n\r\n    public multiply(other: Matrix2D): Matrix2D {\r\n        return this.multiplyArray(other.getElements());\r\n    }\r\n\r\n    public translate(vector: Vector2D): Matrix2D {\r\n        return this.multiplyArray([1, 0, 0, 0, 1, 0, vector.x, vector.y, 1]);\r\n    }\r\n\r\n    public scale(kx: number, ky: number): Matrix2D {\r\n        return this.multiplyArray([kx, 0, 0, 0, ky, 0, 0, 0, 1]);\r\n    }\r\n\r\n    public rotate(deg: number): Matrix2D {\r\n        var angle = deg * Math.PI / 180;\r\n        var ca = Math.cos(angle);\r\n        var sa = Math.sin(angle);\r\n        return this.multiplyArray([ca, sa, 0, -sa, ca, 0, 0, 0, 1]);\r\n    }\r\n\r\n    public reverse(): Matrix2D {\r\n        var det = this.determinant();\r\n\r\n        var ux = this.m[0];\r\n        var uy = this.m[3];\r\n        var uz = this.m[6];\r\n\r\n        var vx = this.m[1];\r\n        var vy = this.m[4];\r\n        var vz = this.m[7];\r\n\r\n        var wx = this.m[2];\r\n        var wy = this.m[5];\r\n        var wz = this.m[8];\r\n\r\n        var c11 = (vy * wz - wy * vz) / det;\r\n        var c12 = (wy * uz - uy * wz) / det;\r\n        var c13 = (uy * vz - vy * uz) / det;\r\n\r\n        var c21 = (wx * vz - vx * wz) / det;\r\n        var c22 = (ux * wz - wx * uz) / det;\r\n        var c23 = (vx * uz - ux * vz) / det;\r\n\r\n        var c31 = (vx * wy - wx * vy) / det;\r\n        var c32 = (wx * uy - ux * wy) / det;\r\n        var c33 = (ux * vy - vx * uy) / det;\r\n\r\n        return new Matrix2D([c11, c21, c31, c12, c22, c32, c13, c23, c33]);\r\n    }\r\n\r\n    public getElements() {\r\n        return this.m.slice(0);\r\n    }\r\n\r\n    private roundFloat(v) {\r\n        return Math.round(v * 1e8) / 1e8;\r\n    }\r\n\r\n    public getTransformExpression() {\r\n        return `matrix(${this.roundFloat(this.m[0])}, ${this.roundFloat(this.m[1])}, ${this.roundFloat(this.m[3])}, ${this.roundFloat(this.m[4])}, ${this.roundFloat(this.m[6])}, ${this.roundFloat(this.m[7])})`;\r\n    }\r\n\r\n}\r\n","class Vector2D {\r\n\r\n    public x: number;\r\n    public y: number;\r\n\r\n    constructor(x: number, y: number) {\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n\r\n    public length() {\r\n        return Math.sqrt(this.x * this.x + this.y * this.y);\r\n    };\r\n\r\n    public sub(other: Vector2D) {\r\n        return new Vector2D(this.x - other.x, this.y - other.y);\r\n    };\r\n\r\n    public add(other: Vector2D) {\r\n        return new Vector2D(this.x + other.x, this.y + other.y);\r\n    };\r\n\r\n    public mul(val: number) {\r\n        return new Vector2D(this.x * val, this.y * val);\r\n    };\r\n\r\n    public rotateClockwise90() {\r\n        return new Vector2D(this.y, -this.x);\r\n    };\r\n\r\n    public rotateCounterClockwise90() {\r\n        return new Vector2D(-this.y, this.x);\r\n    };\r\n\r\n    public changeLength(val: number) {\r\n        var len = this.length();\r\n        if (!len) len = 1;\r\n        return this.mul(val / len);\r\n    };\r\n\r\n    public normalize() {\r\n        return this.changeLength(1);\r\n    }\r\n\r\n    public toString() {\r\n        return `{${this.x}, ${this.y}}`;\r\n    };\r\n\r\n}","///<reference path=\"vector-2d.ts\" />\r\n\r\ninterface IFold {\r\n\r\n    //Fold point on horizontal axis\r\n    foldA: Vector2D;\r\n\r\n    //Second fold point\r\n    foldB: Vector2D;\r\n\r\n\r\n    /**\r\n     * Touch corner position\r\n     */\r\n    pointA: Vector2D;\r\n\r\n    pointB: Vector2D;\r\n\r\n    pointC: Vector2D;\r\n\r\n    pointD: Vector2D;\r\n    \r\n    /**\r\n     * Original corner position (0, 0)\r\n     */\r\n    pointE: Vector2D;\r\n    \r\n}","///<reference path=\"matrix-2d.ts\" />\r\n///<reference path=\"vector-2d.ts\" />\r\n///<reference path=\"fold.ts\" />\r\n///<reference path=\"jquery.d.ts\" />\r\n///<reference path=\"flipper.d.ts\" />\r\n\r\n$.fn.pageTurn = function () {\r\n\r\n    function init($container): IFlipperControl {\r\n        var $scaler = $container.find('.scaler');\r\n\r\n        /** Front side of page being folded */\r\n        var $frontPage: IJQueryNodes;\r\n        var $frontPageImg: IJQueryNodes;\r\n\r\n        /** Back side of page being folded */\r\n        var $backPage: IJQueryNodes;\r\n        var $backPageImg: IJQueryNodes;\r\n\r\n        var touchPointA: Vector2D;\r\n        var touchCorner = '';\r\n        var touchDelta = 0;\r\n\r\n        var animationSemaphore = false;\r\n\r\n        var globalToLocalMatrix: Matrix2D;\r\n        var localToGlobalMatrix: Matrix2D;\r\n        var localToTextureMatrix: Matrix2D;\r\n        var textureToLocalMatrix: Matrix2D;\r\n\r\n        var screenHeight = $scaler.height();\r\n        var screenWidth = $scaler.width();\r\n        var pageHeight = screenHeight;\r\n        var pageWidth = screenWidth / 2;\r\n\r\n        /**\r\n         * Get corner type by jquery node\r\n         */\r\n        function getCornerType($corner: IJQueryNodes): string {\r\n            if ($corner.hasClass('corner-br')) {\r\n                return 'br';\r\n            } else if ($corner.hasClass('corner-bl')) {\r\n                return 'bl';\r\n            } else if ($corner.hasClass('corner-tr')) {\r\n                return 'tr';\r\n            } else if ($corner.hasClass('corner-tl')) {\r\n                return 'tl';\r\n            } else {\r\n                return '';\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Get global to corner local coordinate system transformation matrix\r\n         */\r\n        function getCornerMatrix(corner: string): Matrix2D {\r\n            var m = new Matrix2D();\r\n            switch (corner) {\r\n                case 'br':\r\n                    return m.translate(new Vector2D(-screenWidth, -screenHeight)).scale(-1, -1);\r\n                case 'bl':\r\n                    return m.translate(new Vector2D(0, -screenHeight)).scale(1, -1);\r\n                case 'tr':\r\n                    return m.translate(new Vector2D(-screenWidth, 0)).scale(-1, 1);\r\n                case 'tl':\r\n                    return m.translate(new Vector2D(0, 0)).scale(1, 1);\r\n            }\r\n\r\n            return null;\r\n        }\r\n\r\n        function getCornerShift(corner: string): number {\r\n            switch (corner) {\r\n                case 'br':\r\n                case 'tr':\r\n                    return 2;\r\n                case 'bl':\r\n                case 'tl':\r\n                    return -2;\r\n            }\r\n\r\n            return 0;\r\n        }\r\n\r\n        /**\r\n         * Get local to texture transform matrix\r\n         */\r\n        function getLocalToTextureMatrix(corner: string): Matrix2D {\r\n            var m = new Matrix2D();\r\n            switch (corner) {\r\n                case 'br':\r\n                    return m.scale(-1, -1).translate(new Vector2D(pageWidth, pageHeight));\r\n                case 'tr':\r\n                    return m.scale(-1, 1).translate(new Vector2D(pageWidth, 0));\r\n                case 'bl':\r\n                    return m.scale(1, -1).translate(new Vector2D(0, pageHeight));\r\n                case 'tl':\r\n                    return m.scale(1, 1).translate(new Vector2D(0, 0));\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Get back side of page being fold\r\n         */\r\n        function getBackPage(corner: string): IJQueryNodes {\r\n            switch (corner) {\r\n                case 'br':\r\n                case 'tr':\r\n                    return $container.find('.page3');\r\n                case 'bl':\r\n                case 'tl':\r\n                    return $container.find('.page2');\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Get front side of page being fold\r\n         */\r\n        function getFrontPage(corner: string): IJQueryNodes {\r\n            switch (corner) {\r\n                case 'br':\r\n                case 'tr':\r\n                    return $container.find('.page2');\r\n                case 'bl':\r\n                case 'tl':\r\n                    return $container.find('.page3');\r\n            }\r\n        }\r\n\r\n        function initCorner(corner: string) {\r\n            screenHeight = $scaler.height();\r\n            screenWidth = $scaler.width();\r\n            pageHeight = screenHeight;\r\n            pageWidth = screenWidth / 2;\r\n\r\n            var $current = $container.find('li.current');\r\n            switch (corner) {\r\n                case 'tr':\r\n                case 'br':\r\n                    $container.addClass('active').addClass('active-next').removeClass('active-prev');\r\n                    if ($container.find('li.current').next('li')) {\r\n                        cleanPages();\r\n                        $current.addClass('page1').next('li').addClass('page2').next('li').addClass('page3').next('li').addClass('page4');\r\n                    }\r\n                    break;\r\n                case 'tl':\r\n                case 'bl':\r\n                    $container.addClass('active').removeClass('active-next').addClass('active-prev');\r\n                    if ($container.find('li.current').prev('li').length) {\r\n                        cleanPages();\r\n                        $current.next('li').addClass('page4').prev('li').addClass('page3').prev('li').addClass('page2').prev('li').addClass('page1');\r\n                    }\r\n                    break;\r\n                default:\r\n                    $container.removeClass('active').removeClass('active-next').removeClass('active-prev');\r\n                    break;\r\n            }\r\n\r\n            $frontPage = getFrontPage(corner);\r\n            $backPage = getBackPage(corner);\r\n\r\n            $frontPageImg = $frontPage.find('img');\r\n            $backPageImg = $backPage.find('img');\r\n\r\n            touchCorner = corner;\r\n            touchDelta = getCornerShift(corner);\r\n\r\n            globalToLocalMatrix = getCornerMatrix(corner);\r\n            localToGlobalMatrix = globalToLocalMatrix.reverse();\r\n\r\n            localToTextureMatrix = getLocalToTextureMatrix(corner);\r\n            textureToLocalMatrix = localToTextureMatrix.reverse();\r\n        }\r\n\r\n        /**\r\n         * Check pointA to spine distance. We dont want page to be torn...\r\n         */\r\n        function fixPointA(pointA: Vector2D): Vector2D {\r\n            if (pointA.length() < 10) pointA = new Vector2D(0, 0);\r\n\r\n            var spinePointB = new Vector2D(pageWidth, pageHeight);\r\n            var maxDiag = spinePointB.length();\r\n            var diag = pointA.sub(spinePointB);\r\n            if (diag.length() > maxDiag) {\r\n                diag = diag.changeLength(maxDiag);\r\n                pointA = diag.add(spinePointB);\r\n            }\r\n\r\n            var spinePointA = new Vector2D(pageWidth, 0);\r\n            var dir = pointA.sub(spinePointA);\r\n            if (dir.length() > pageWidth) {\r\n                dir = dir.changeLength(pageWidth);\r\n                pointA = dir.add(spinePointA);\r\n            }\r\n\r\n            return pointA;\r\n        }\r\n\r\n        /**\r\n         * Easing function\r\n         */\r\n        function easeInOutCubic(t: number, b: number, c: number, d: number): number {\r\n            t /= d / 2;\r\n            if (t < 1) return c / 2 * t * t * t + b;\r\n            t -= 2;\r\n            return c / 2 * (t * t * t + 2) + b;\r\n        };\r\n\r\n        (function () {\r\n            var mouseDownStart: Vector2D;\r\n            var state = 'init';\r\n            var $handle: IJQueryNodes;\r\n\r\n            var dragging = null;\r\n            var draggingPreview = null;\r\n\r\n            function getMousePosition(ev: IJQueryEvent): Vector2D {\r\n                if (ev.type.indexOf('touch') >= 0) {\r\n                    var touchEvent = <TouchEvent>ev.originalEvent\r\n                    var touch = touchEvent.touches[0] || touchEvent.changedTouches[0];\r\n                    return new Vector2D(touch.clientX, touch.clientY);\r\n                }\r\n                return new Vector2D(ev.clientX, ev.clientY);\r\n            }\r\n\r\n            function checkThreshold(a: Vector2D, b: Vector2D): boolean {\r\n                return a.sub(b).length() > 5;\r\n            }\r\n\r\n            function createDragArgs(ev: IJQueryEvent) {\r\n                var pos = getMousePosition(ev);\r\n                var rect = $scaler[0].getBoundingClientRect();\r\n                var start = new Vector2D(rect.left, rect.top);\r\n                return {\r\n                    rel: pos.sub(start),\r\n                    $handle: $handle,\r\n                    event: ev\r\n                };\r\n            }\r\n\r\n            function dragStart(ev: IJQueryEvent) {\r\n                var args = createDragArgs(ev);\r\n                var corner = getCornerType(args.$handle);\r\n                initCorner(corner);\r\n\r\n                dragging = {};\r\n                draggingPreview = null;\r\n                return true;\r\n            }\r\n\r\n            function dragMove(ev: IJQueryEvent) {\r\n                if (dragging) {\r\n                    dragFold(ev);\r\n                }\r\n            }\r\n\r\n            function dragFold(ev: IJQueryEvent) {\r\n                var args = createDragArgs(ev);\r\n                touchPointA = globalToLocalMatrix.transformVector(args.rel);\r\n                refresh(touchPointA);\r\n            }\r\n\r\n            function dragAnimate(target: Vector2D) {\r\n                var start = touchPointA;\r\n                var delta = target.sub(start);\r\n                return animate((stage: number) => {\r\n                    var vector = delta.mul(stage).add(start);\r\n                    touchPointA = vector;\r\n                    refresh(vector);\r\n                }).done(() => {\r\n                    cleanPages();\r\n                    clean();\r\n                });\r\n            }\r\n\r\n            function dragEnd(ev: IJQueryEvent) {\r\n                if (dragging) {\r\n                    var screenWidth = $scaler.width();\r\n                    var pageWidth = screenWidth / 2;\r\n                    if (touchPointA.x > pageWidth) {\r\n                        dragAnimate(new Vector2D(screenWidth, 0)).done(() => {\r\n                            shiftCurrent(touchDelta);\r\n                        });\r\n                    } else {\r\n                        dragCancel(ev);\r\n                    }\r\n                    dragging = null;\r\n                }\r\n            }\r\n\r\n            function dragCancel(ev: IJQueryEvent) {\r\n                if (dragging) {\r\n                    dragAnimate(new Vector2D(0, 0));\r\n                    dragging = null;\r\n                }\r\n            }\r\n\r\n            function dragCheck(ev: IJQueryEvent, canCancel: boolean): any {\r\n                if (state === 'drag') {\r\n                    if (canCancel) {\r\n                        ev.preventDefault();\r\n                        ev.stopPropagation();\r\n                    }\r\n                    return dragMove(ev);\r\n                } else if (state === 'threshold') {\r\n                    var pos = getMousePosition(ev);\r\n                    if (checkThreshold(mouseDownStart, pos)) {\r\n                        state = 'drag';\r\n                        var res = dragStart(ev);\r\n                        if (!res) state = 'init';\r\n                        return res;\r\n                    }\r\n                }\r\n                return true;\r\n            }\r\n\r\n            $('html, body').on('mousedown touchstart', '.page-turn .corner', function (ev) {\r\n                var $evtarget = $(ev.target);\r\n                if (state === 'init') {\r\n                    mouseDownStart = getMousePosition(ev);\r\n                    ev.preventDefault();\r\n                    ev.stopPropagation();\r\n                    state = 'threshold';\r\n                    $handle = $evtarget.closest('.corner');\r\n                }\r\n            }).on('mousemove touchmove', '.page-turn .corner', function (ev) {\r\n                if (dragging) return;\r\n                draggingPreview = {};\r\n                $handle = $(ev.target).closest('.corner');\r\n                var args = createDragArgs(ev);\r\n                var corner = getCornerType(args.$handle);\r\n                initCorner(corner);\r\n                dragFold(ev);\r\n            }).on('mouseout touchend', '.page-turn .corner', function (ev) {\r\n                if (!draggingPreview) return;\r\n                draggingPreview = null;\r\n                dragAnimate(new Vector2D(0, 0));\r\n            }).bind('mousemove touchmove', function (ev) {\r\n                return dragCheck(ev, true);\r\n            }).bind('mousewheel', function (ev) {\r\n                return dragCheck(ev, false);\r\n            }).bind('mouseup touchend', function (ev: IJQueryEvent) {\r\n                if (state === 'drag') {\r\n                    ev.preventDefault();\r\n                    ev.stopPropagation();\r\n                    dragEnd(ev);\r\n                } else if (state === 'threshold') {\r\n                    animateArrow(getCornerType($handle));\r\n                }\r\n                state = 'init';\r\n            }).bind('keydown', function (ev) {\r\n                if (!dragging) return;\r\n\r\n                if (ev.keyCode === 27) {      //escape\r\n                    dragCancel(ev);\r\n                }\r\n            });\r\n\r\n        })();\r\n\r\n        /**\r\n         * Get touch point vector during auto-animation. Fold point x and Fold angle is animated.\r\n         * @param stage Number from 0 to 1.\r\n         */\r\n        function getPointAFromStage(stage: number): Vector2D {\r\n            var angle = 45 + 45 * stage; //symmetry line angle changes from 45 to 90.\r\n            angle = angle * Math.PI / 180;\r\n\r\n            var fx = stage * pageWidth;\r\n            var fy = 0;\r\n\r\n            var foldA = new Vector2D(fx, fy);\r\n\r\n            var dpl = fx * Math.cos(angle);\r\n            var dpx = dpl * Math.cos(angle);\r\n            var dpy = dpl * Math.sin(angle);\r\n\r\n            var pointM = new Vector2D(fx - dpx, dpy);\r\n\r\n            return pointM.mul(2);\r\n        }\r\n\r\n        function getFoldB(pointA: Vector2D, pointB: Vector2D, pointC: Vector2D) {\r\n            var ba = pointB.sub(pointA);\r\n\r\n            if (ba.x == 0) {\r\n                return new Vector2D(pointA.x, pageHeight);\r\n            }\r\n            var kx = -pointA.x / ba.x;\r\n            if (kx >= 0 && kx <= 1) {\r\n                return ba.mul(kx).add(pointA);\r\n            }\r\n\r\n            var cb = pointC.sub(pointB);\r\n            var ky = (pageHeight - pointB.y) / cb.y;\r\n            return cb.mul(ky).add(pointB);\r\n        }\r\n\r\n        function calculateFoldByCorner(pointA: Vector2D): IFold {\r\n            var pointM = pointA.mul(0.5);\r\n            var symmetryLine = pointM.rotateClockwise90(); // starts at pointM and goes to both directions\r\n\r\n            var foldA: Vector2D;\r\n            if (symmetryLine.y != 0) {\r\n                var ka = -pointM.y / symmetryLine.y;\r\n                foldA = pointM.add(symmetryLine.mul(ka));\r\n            } else {\r\n                foldA = new Vector2D(pointM.x, 0);\r\n            }\r\n\r\n            var pointB: Vector2D;\r\n            if (foldA.x == pointA.x && foldA.y == pointA.y) {\r\n                pointB = pointA.add(new Vector2D(0, pageHeight));\r\n            } else {\r\n                pointB = foldA.sub(pointA).rotateClockwise90().changeLength(pageHeight).add(pointA);\r\n            }\r\n\r\n            var pointC = pointA.sub(pointB).rotateClockwise90().changeLength(pageWidth).add(pointB);\r\n            var pointD = pointB.sub(pointC).rotateClockwise90().changeLength(pageHeight).add(pointC);\r\n\r\n            return {\r\n                pointA: pointA,\r\n                pointB: pointB,\r\n                pointC: pointC,\r\n                pointD: pointD,\r\n                pointE: new Vector2D(0, 0),\r\n                foldA: foldA,\r\n                foldB: getFoldB(pointA, pointB, pointC)\r\n            }\r\n        }\r\n\r\n        function calculateFold(): IFold {\r\n            var pointA = touchPointA;// getPointAFromStage(stage);\r\n            pointA = fixPointA(pointA);\r\n            var fold = calculateFoldByCorner(pointA);\r\n\r\n            return {\r\n                foldA: fold.foldA,\r\n                foldB: fold.foldB,\r\n                pointA: fold.pointA,\r\n                pointB: fold.pointB,\r\n                pointC: fold.pointC,\r\n                pointD: fold.pointD,\r\n                pointE: fold.pointE\r\n            };\r\n        }\r\n\r\n        function dumpFold(localFold: IFold) {\r\n            function debugPoint($point: IJQueryNodes, vector: Vector2D) {\r\n                vector = localToGlobalMatrix.transformVector(vector);\r\n                $point.css({\r\n                    left: (100 * vector.x / screenWidth) + '%',\r\n                    top: (100 * vector.y / screenHeight) + '%'\r\n                })\r\n            }\r\n\r\n            debugPoint($('.fold-point-A'), localFold.foldA);\r\n            debugPoint($('.fold-point-B'), localFold.foldB);\r\n            debugPoint($('.point-a'), localFold.pointA);\r\n            debugPoint($('.point-b'), localFold.pointB);\r\n            debugPoint($('.point-c'), localFold.pointC);\r\n            debugPoint($('.point-d'), localFold.pointD);\r\n            debugPoint($('.point-e'), localFold.pointE);\r\n        }\r\n\r\n        function getOuterClipMatrix(pointO: Vector2D, pointU: Vector2D, pointV: Vector2D): Matrix2D {\r\n            var clipX = pointU.sub(pointO).mul(1 / pageWidth);\r\n            var clipY = pointV.sub(pointO).mul(1 / pageHeight);\r\n            return new Matrix2D([clipX.x, clipX.y, 0, clipY.x, clipY.y, 0, 0, 0, 1]).translate(pointO);\r\n        }\r\n\r\n        /**\r\n         * Get trapezoid clipper matrix.\r\n         */\r\n        function getTrapezoidClipperMatrix(pointO: Vector2D, pointU: Vector2D, pointV: Vector2D, pointW: Vector2D): Matrix2D {\r\n            var axisX = pointU.sub(pointO);\r\n            var axisY = pointV.sub(pointO);\r\n            var dirX = axisX.normalize();\r\n            var dirY = axisY.normalize();\r\n            var axisMatrix = new Matrix2D([dirX.x, dirX.y, 0, dirY.x, dirY.y, 0, 0, 0, 1]);\r\n\r\n            //make sure pointW is included into the matrix\r\n            var matrix = axisMatrix.translate(pointO);\r\n            var reverse = matrix.reverse();\r\n            var checkPoint = reverse.transformVector(pointW);\r\n\r\n            var kx = checkPoint.x / axisX.length();\r\n            var ky = checkPoint.y / axisY.length();\r\n            var k = Math.max(kx, ky, 1);\r\n            return axisMatrix.scale(k, k).translate(pointO);\r\n        }\r\n\r\n        /**\r\n         * Setups page using page martix and clipper matrix\r\n         * @param pageMatrix Page matrix in corner local coordinate system\r\n         * @param clipperMatrix Clipper matrix in corner local coordinate system\r\n         */\r\n        function setupPage($page: IJQueryNodes, $img: IJQueryNodes, pageMatrix: Matrix2D, clipperMatrix: Matrix2D) {\r\n            pageMatrix = pageMatrix.multiply(localToGlobalMatrix);\r\n            clipperMatrix = clipperMatrix.multiply(localToGlobalMatrix);\r\n\r\n            $page.css({\r\n                transform: clipperMatrix.getTransformExpression()\r\n            })\r\n\r\n            pageMatrix = pageMatrix.multiply(clipperMatrix.reverse()); //compensate clipper matrix\r\n\r\n            $img.css({\r\n                transform: pageMatrix.getTransformExpression()\r\n            })\r\n        }\r\n\r\n        function getPageMatrix(fold: IFold) {\r\n            var pageXAxis = fold.pointA.sub(fold.pointD).normalize();\r\n            var pageYAxis = fold.pointC.sub(fold.pointD).normalize();\r\n            var pageMatrix = new Matrix2D([pageXAxis.x, pageXAxis.y, 0, pageYAxis.x, pageYAxis.y, 0, 0, 0, 1]).translate(fold.pointD);\r\n\r\n            return textureToLocalMatrix.multiply(pageMatrix);\r\n        }\r\n\r\n        function setupBackPage(localFold: IFold) {\r\n            var pageMatrix = getPageMatrix(localFold);\r\n\r\n            var clipperMatrix: Matrix2D;\r\n            if (localFold.foldA.x > localFold.foldB.x) { //triangle or trapezoid?\r\n                clipperMatrix = getOuterClipMatrix(localFold.foldA, localFold.pointA, localFold.foldB);\r\n            } else {\r\n                clipperMatrix = getOuterClipMatrix(localFold.foldB, localFold.pointB, localFold.foldA);\r\n            }\r\n\r\n            setupPage($backPage, $backPageImg, pageMatrix, clipperMatrix);\r\n        }\r\n\r\n        function setupFrontPage(localFold: IFold) {\r\n            var shift = textureToLocalMatrix.transformVector(new Vector2D(0, 0));\r\n            shift = localToGlobalMatrix.transformVector(shift);\r\n            var pageMatrix = new Matrix2D().translate(shift).multiply(globalToLocalMatrix);\r\n\r\n            var spineA = new Vector2D(pageWidth, 0).mul(2); //Scale it by any number >1 to avoid zero axis length\r\n            var spineB = new Vector2D(pageWidth, pageHeight).mul(2); //Scale it by any number >1 to avoid zero axis length\r\n            var clipperMatrix: Matrix2D;\r\n            if (localFold.foldA.x > localFold.foldB.x) { //triangle or trapezoid?\r\n                clipperMatrix = getTrapezoidClipperMatrix(localFold.foldA, spineA, localFold.foldB, spineB);\r\n            } else {\r\n                clipperMatrix = getTrapezoidClipperMatrix(localFold.foldB, spineB, localFold.foldA, spineA);\r\n            }\r\n\r\n            setupPage($frontPage, $frontPageImg, pageMatrix, clipperMatrix);\r\n        }\r\n\r\n        function refresh(pointA: Vector2D) {\r\n            var localFold = calculateFold();\r\n\r\n            setupBackPage(localFold);\r\n            setupFrontPage(localFold);\r\n\r\n            // dumpFold(localFold);\r\n        }\r\n\r\n        function cleanPages() {\r\n            return $container.find('li').removeClass('page1 page2 page3 page4')\r\n        }\r\n\r\n        function clean() {\r\n            $container.removeClass('active').find('li').css('transform', '').find('img').css('transform', '');\r\n        }\r\n\r\n        function refreshState() {\r\n            var $current = $container.find('li.current');\r\n            var $prev = $current.prev('li');\r\n            var $next = $current.next('li');\r\n            $container.toggleClass('can-prev-2', !!$prev.length && !$prev.hasClass('empty'));\r\n            $container.toggleClass('can-next-2', !!$next.length && !$next.hasClass('empty'));\r\n\r\n            var twoSides = !$current.hasClass('empty') && !!$next.length && !$next.hasClass('empty');\r\n            $container.toggleClass('two-sides', twoSides)\r\n        }\r\n\r\n        function shiftCurrent(delta: number) {\r\n            var $current = $container.find('li.current');\r\n            var $currentOne = $container.find('li.current-one');\r\n\r\n            var $node = $current;\r\n            var $nodeOne = $currentOne;\r\n            while (delta >= 2) {\r\n                $node = $node.next('li').next('li');;\r\n                $nodeOne = $nodeOne.next('li').next('li');;\r\n                delta -= 2;\r\n            }\r\n            while (delta <= -2) {\r\n                $node = $node.prev('li').prev('li');;\r\n                $nodeOne = $nodeOne.prev('li').prev('li');;\r\n                delta += 2;\r\n            }\r\n            while (delta >= 1) {\r\n                if ($node[0] === $nodeOne[0]) {\r\n                    $nodeOne = $nodeOne.next('li');\r\n                } else {\r\n                    $node = $node.next('li').next('li');\r\n                    $nodeOne = $nodeOne.next('li');\r\n                }\r\n                delta--;\r\n            }\r\n            while (delta <= -1) {\r\n                if ($node[0] === $nodeOne[0]) {\r\n                    $node = $node.prev('li').prev('li');\r\n                    $nodeOne = $nodeOne.prev('li');\r\n                } else {\r\n                    $nodeOne = $nodeOne.prev('li');\r\n                }\r\n                delta++;\r\n            }\r\n            if ($node.length) {\r\n                $current.removeClass('current');\r\n                $currentOne.removeClass('current-one');\r\n                $node.addClass('current');\r\n                $nodeOne.addClass('current-one');\r\n            }\r\n\r\n            refreshState();\r\n\r\n            preloadImages();\r\n\r\n            return $node;\r\n        }\r\n\r\n        function animate(callback: { (stage: number) }) {\r\n            var promise = $.Deferred();\r\n            if (animationSemaphore) {\r\n                promise.reject();\r\n                return promise;\r\n            }\r\n\r\n            animationSemaphore = true;\r\n\r\n\r\n            var frame = 0;\r\n            var step = 4;\r\n\r\n            callback(0);\r\n\r\n            function draw() {\r\n                requestAnimationFrame(() => {\r\n                    frame += step;\r\n                    frame = Math.min(frame, 100);\r\n                    var x = easeInOutCubic(frame / 100, 0, 1, 1);\r\n                    callback(x)\r\n                    if (frame < 100) {\r\n                        draw();\r\n                    } else {\r\n                        animationSemaphore = false;\r\n                        promise.resolve();\r\n                    }\r\n                });\r\n            }\r\n\r\n            draw();\r\n\r\n            return promise;\r\n        }\r\n\r\n        function animateArrow(corner: string) {\r\n            initCorner(corner);\r\n            animate(stage => {\r\n                var pointA = getPointAFromStage(stage);\r\n                touchPointA = pointA;\r\n                refresh(touchPointA);\r\n            }).done(() => {\r\n                cleanPages();\r\n                clean();\r\n                shiftCurrent(touchDelta);\r\n            });\r\n        }\r\n\r\n        function preloadImages() {\r\n            preloadNextImages();\r\n            preloadPrevImages();\r\n        }\r\n\r\n        var preloaders = {};\r\n\r\n        function preloadImage($img: IJQueryNodes) {\r\n            if (!$img.length) return;\r\n            var imgNode = <HTMLImageElement>$img[0];\r\n            var src = imgNode.src;\r\n            var img = new Image()\r\n            img.src = src;\r\n            img.onload = function () {\r\n                console.log(src);\r\n            }\r\n            preloaders[src] = img;\r\n        }\r\n\r\n        function preloadNextImages() {\r\n            var $current = $scaler.find('li.current');\r\n            for (var i = 0; i < 3; i++) {\r\n                $current = $current.next('li');\r\n                var $img = $current.find('img');\r\n                preloadImage($img);\r\n            }\r\n        }\r\n\r\n        function preloadPrevImages() {\r\n            var $current = $scaler.find('li.current');\r\n            for (var i = 0; i < 3; i++) {\r\n                $current = $current.prev('li');\r\n                var $img = $current.find('img');\r\n                preloadImage($img);\r\n            }\r\n        }\r\n\r\n        function animateFlipForward() {\r\n            var $newBase = $container.find('li.current').next('li');\r\n            if ($newBase.length) {\r\n                animateArrow('br');\r\n            }\r\n        }\r\n\r\n        function animateFlipBackward() {\r\n            var $newBase = $container.find('li.current').prev('li');\r\n            if ($newBase.length) {\r\n                animateArrow('bl');\r\n            }\r\n        }\r\n\r\n        function navigate(pageNumber: number) {\r\n            var $pages = $container.find('li:not(.empty)').removeClass('current-one');\r\n            pageNumber = Math.min(Math.max(1, pageNumber), $pages.length + 1);\r\n            for (var i = 0; i < $pages.length; i += 2) {\r\n                var page = i + 1;\r\n                var $page1 = $($pages[i]);\r\n                $page1.toggleClass('current', page == pageNumber || (page + 1) == pageNumber);\r\n                $page1.toggleClass('current-one', page == pageNumber);\r\n                if (i + 1 < $pages.length) {\r\n                    var $page2 = $($pages[i + 1]);\r\n                    $page2.toggleClass('current-one', (page + 1) == pageNumber);\r\n                }\r\n            }\r\n        }\r\n\r\n        preloadImages();\r\n        refreshState();\r\n\r\n        return {\r\n            animateFlipBackward: animateFlipBackward,\r\n            animateFlipForward: animateFlipForward,\r\n            shiftCurrent: shiftCurrent,\r\n            navigate: navigate\r\n        }\r\n    }\r\n\r\n    var data = this.data('page-turn');\r\n    if (data) return data;\r\n    data = init(this);\r\n    this.data('page-turn', data);\r\n    return data;\r\n};\r\n\r\n$(document).ready(function () {\r\n    var data = $('.page-turn').pageTurn();\r\n    $('body').on('click', '.page-turn .nav-next-2', () => {\r\n        data.animateFlipForward();\r\n    }).on('click', '.page-turn .nav-prev-2', () => {\r\n        data.animateFlipBackward();\r\n    }).on('click', '.page-turn .nav-next', () => {\r\n        data.shiftCurrent(1);\r\n    }).on('click', '.page-turn .nav-prev', () => {\r\n        data.shiftCurrent(-1);\r\n    });\r\n});\r\n\r\n"],"sourceRoot":"/source/"}